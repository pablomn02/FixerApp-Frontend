<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Perfil Profesional</ion-title>
    <ion-buttons slot="end">
      <ion-button fill="clear" (click)="closeModal()">
        <ion-icon name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="bg-primary" [fullscreen]="true">
  <div class="profile-section">
    <div class="profile-avatar">
      <ion-icon name="person-circle-outline"></ion-icon>
    </div>
    <div class="profile-info">
      <h2>{{ profesional.nombre }}</h2>
      <p class="specialty">{{ profesional.especialidad }}</p>
      <p class="experience">Precio: {{ profesional.precioHora }} €/h</p>

      <div class="rating-average" *ngIf="profesional.valoracionMedia">
        <div class="stars-container">
          <span class="star" 
                *ngFor="let star of [1,2,3,4,5]" 
                [class.filled]="star <= Math.floor(profesional.valoracionMedia)"
                [class.half-filled]="star === Math.ceil(profesional.valoracionMedia) && profesional.valoracionMedia % 1 !== 0">
            ⭐
          </span>
        </div>
        <div class="rating-text">
          <span class="rating-number">{{ profesional.valoracionMedia }}</span>/5
        </div>
      </div>
    </div>

    <ion-button
      class="favorite-btn"
      [class.favorito]="isFavorito"
      [class.loading]="cargandoFavorito"
      fill="clear"
      (click)="toggleFavorito()"
      [disabled]="cargandoFavorito"
    >
      <ion-icon
        *ngIf="!cargandoFavorito"
        [name]="isFavorito ? 'heart' : 'heart-outline'"
      ></ion-icon>
      <ion-spinner *ngIf="cargandoFavorito" name="crescent"></ion-spinner>
    </ion-button>
  </div>
  
  <ion-list *ngIf="valoraciones.length > 0" class="valoraciones-list">
    <h5>Valoraciones</h5>
    <ion-item *ngFor="let valoracion of valoraciones">
      <ion-label>
        <h3>{{ valoracion.nombreCliente }}</h3>
        <p class="comment">{{ valoracion.comentario }}</p>
        <div class="client-stars">
          <span class="star"
                *ngFor="let star of [1,2,3,4,5]"
                [class.filled]="star <= valoracion.puntuacion">
            ⭐
          </span>
          <span class="rating-value">{{ valoracion.puntuacion }}/5</span>
        </div>
      </ion-label>
    </ion-item>
  </ion-list>

  <ion-text color="medium" *ngIf="valoraciones.length === 0">
    <p class="ion-padding">Este profesional aún no tiene valoraciones.</p>
  </ion-text>
</ion-content>
